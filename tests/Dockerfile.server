FROM gcc:latest

COPY . /quic-nfs
WORKDIR /quic-nfs

RUN ./install_dependencies

WORKDIR /quic-nfs
# create a directory for export
RUN mkdir -p /nfs_share
# mark /nfs_share as exported
RUN touch exports && \
    echo "/nfs_share *(rw)" >> ./exports
# create a file inside it for testing purposes
RUN touch /nfs_share/test_file.txt && \
    echo "test_content" >> /nfs_share/test_file.txt

RUN chmod +x ./build/mount_and_nfs_server
CMD ["./build/mount_and_nfs_server"]